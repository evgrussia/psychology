# Техническая спецификация фичи (Tech Spec)

**Проект:** «Эмоциональный баланс»  
**Версия спеки:** v0.1 (draft)  
**Автор:** Cursor Agent  
**Дата:** 2026-01-07  
**Статус:** draft  

**Feature ID:** `FEAT-WEB-03`  
**Epic:** `EPIC-01`  
**Приоритет:** P0  
**Трекер:** —  

**Оценка реализации агентом Cursor:** ~40k токенов (≤ 270k)

---

## 1) Summary (коротко)

### 1.1 Что делаем
Добавляем служебные и юридические страницы + страницу “экстренная помощь”, а также базовые дисклеймеры “не диагноз/не экстренная помощь” на критичных поверхностях.

### 1.2 Почему сейчас (контекст / метрики / риск)
- **Сигнал/боль:** PRD/NFR требуют этику и кризисный режим как guardrail.
- **Ожидаемый эффект:** снижение репутационных/юридических рисков.
- **Если не сделать:** блокер запуска (go live).

### 1.3 Ссылки на первоисточники
- PRD: `docs/PRD.md` (Constraints, NFR-TOV, NFR-SEC)
- IA: `docs/information-architecture.md` (`/legal/*`, `/emergency/`, `/404/`)
- UGC rules: `docs/UGC-Moderation-Rules.md` (кризис-процедуры)
- A11y: `docs/Accessibility-A11y-Requirements.md`

---

## 2) Goals / Non-goals

### 2.1 Goals (что обязательно)
- **G1:** Страницы:
  - `/emergency/`
  - `/legal/privacy/`
  - `/legal/personal-data-consent/`
  - `/legal/offer/`
  - `/legal/disclaimer/`
  - `/legal/cookies/` (если применимо)
  - `/404/`
- **G2:** Единый компонент дисклеймера для интерактивов/контента/booking.
- **G3:** Экстренная помощь доступна из footer и кризисных поверхностей.

### 2.2 Non-goals (что осознанно НЕ делаем)
- **NG1:** Полная юридическая экспертиза текстов (контентная задача), но каркас страниц обязателен.

---

## 3) Scope (границы и сценарии)

### 3.1 In-scope (конкретные сценарии)
- **US-1:** Пользователь открывает `/emergency/` с любой страницы.
- **US-2:** Пользователь видит дисклеймер на интерактивах и понимает границы продукта.

### 3.3 Acceptance criteria (AC)
- [ ] AC-1 Все URL существуют и доступны публично.
- [ ] AC-2 В footer есть ссылки на legal + emergency.
- [ ] AC-3 Компонент дисклеймера переиспользуется в интерактивах/контенте/booking.

### 3.4 Негативные сценарии (обязательные)
- **NS-1:** 404 отображает “С чего начать” и поиск по контенту (если есть).

---

## 4) UX / UI (что увидит пользователь)

### 4.1 Изменения экранов/страниц
Список URL — выше.

### 4.2 A11y (минимум)
- [ ] Телефоны/ссылки на помощь доступны клавиатурой и корректно озвучиваются.
- [ ] Заголовки и списки семантичны.

---

## 5) Архитектура и ответственность слоёв (Clean Architecture)

### 5.1 Компоненты/модули
- **Presentation:** статические страницы (SSG) или CMS `content_type=page`.
- **Application/Domain:** при хранении в CMS — `GetPageBySlugUseCase`.
- **Infrastructure:** content repo.

---

## 6) Модель данных (БД) и миграции
Если legal страницы храним в CMS — используем `content_items` (type `page`), миграций нет.

---

## 7) API / Контракты (если применимо)
Если legal страницы в CMS:
- `GET /api/public/pages/{slug}`

---

## 8) Tracking / Analytics (по `docs/Tracking-Plan.md`)

### 8.1 События (таблица)
| Event name | Source | Когда срабатывает | Props (P0-only) | Запреты |
|---|---|---|---|---|
| `crisis_help_click` | web | клик на action в emergency | `action` | — |

---

## 9) Security / Privacy / Compliance

### 9.1 Privacy by design (обязательные пункты)
- [ ] Legal страницы описывают согласия/политику (контент), а технически — минимизируем сбор данных.

### 9.3 Кризисный режим (если применимо)
- `/emergency/` — единый источник правды; интерактивы/UGC ссылаются на него.

---

## 10) Надёжность, производительность, деградации
SSG предпочтительно.

---

## 11) Rollout plan
Включаем сразу.

---

## 12) Test plan

### 12.3 E2E (критические happy paths)
- с любой страницы footer → `/emergency/`
- `/404/` показывает полезные ссылки

### 12.5 A11y smoke
- [ ] таб по “экстренная помощь” действиям

---

## 13) Open questions / решения

### 13.1 Вопросы
- [ ] Нужна ли `/legal/cookies/` (зависит от наличия cookie-баннера/аналитики).

### 13.2 Decision log (что и почему решили)
- **2026-01-07:** emergency и дисклеймеры — обязательные guardrails релиза 1.

