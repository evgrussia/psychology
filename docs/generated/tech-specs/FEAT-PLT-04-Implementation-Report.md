# –û—Ç—á–µ—Ç –æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ FEAT-PLT-04: –ú–µ–¥–∏–∞-—Å—Ç–∞—Ç–∏–∫–∞ (VPS)

**–î–∞—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏:** 2026-01-13  
**–í–µ—Ä—Å–∏—è —Ç–µ—Ö—Å–ø–µ–∫–∏:** v0.1 (draft)  
**–°—Ç–∞—Ç—É—Å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:** ‚úÖ **–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —Å –∑–∞–º–µ—á–∞–Ω–∏—è–º–∏**

---

## üìä –û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞

**–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ç–µ—Ö—Å–ø–µ–∫–∏:** **100%** ‚úÖ

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- ‚úÖ –û—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –∑–∞–≥—Ä—É–∑–∫–∏/—É–¥–∞–ª–µ–Ω–∏—è –º–µ–¥–∏–∞
- ‚úÖ –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ñ–∞–π–ª–æ–≤–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
- ‚úÖ –†–∞–∑–¥–∞—á–∞ —Å—Ç–∞—Ç–∏–∫–∏ —á–µ—Ä–µ–∑ NestJS
- ‚úÖ RBAC –¥–ª—è –∞–¥–º–∏–Ω—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–∏–ø–æ–≤ –∏ —Ä–∞–∑–º–µ—Ä–æ–≤ —Ñ–∞–π–ª–æ–≤
- ‚úÖ –î–æ–º–µ–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –º–µ–¥–∏–∞ –ø–µ—Ä–µ–¥ —É–¥–∞–ª–µ–Ω–∏–µ–º
- ‚úÖ **–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–æ—Å—Ç—å –∏ cleanup –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö –∑–∞–ø–∏—Å–∏ —Ñ–∞–π–ª–∞**
- ‚úÖ **–í–∞–ª–∏–¥–∞—Ü–∏—è alt_text –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (A11y)**
- ‚úÖ **Feature flag `MEDIA_UPLOAD_ENABLED` –¥–ª—è –ø–æ—ç—Ç–∞–ø–Ω–æ–≥–æ rollout**
- ‚úÖ **Tracking —Å–æ–±—ã—Ç–∏–µ `admin_media_uploaded` –ø–æ–¥–∫–ª—é—á–µ–Ω–æ**
- ‚úÖ **Unit —Ç–µ—Å—Ç—ã –¥–ª—è –æ—Å–Ω–æ–≤–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤**
- ‚úÖ **Integration —Ç–µ—Å—Ç—ã –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ flow**

**–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è (–Ω–µ –±–ª–æ–∫–∏—Ä—É—é—Ç —Ä–µ–ª–∏–∑):**
- ‚ö†Ô∏è –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –ø–æ checksum (–ø–æ–º–µ—á–µ–Ω–æ –∫–∞–∫ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –≤ —Ç–µ—Ö—Å–ø–µ–∫–∏)

---

## 1Ô∏è‚É£ Goals (–¶–µ–ª–∏)

### G1: Upload flow ‚úÖ
**–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ:** –ê–¥–º–∏–Ω –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Ñ–∞–π–ª ‚Üí —Ñ–∞–π–ª —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –∫–∞—Ç–∞–ª–æ–≥ –º–µ–¥–∏–∞ –Ω–∞ VPS ‚Üí —Å–æ–∑–¥–∞—ë—Ç—Å—è –∑–∞–ø–∏—Å—å `media_assets` ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –ø—É–±–ª–∏—á–Ω—ã–π URL.

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- ‚úÖ `UploadMediaAssetUseCase` —Ä–µ–∞–ª–∏–∑—É–µ—Ç –ø–æ–ª–Ω—ã–π flow
- ‚úÖ `LocalFsStorageService` —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ñ–∞–π–ª—ã –≤ –ª–æ–∫–∞–ª—å–Ω—É—é —Ñ–∞–π–ª–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É
- ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è `object_key` –≤ —Ñ–æ—Ä–º–∞—Ç–µ `YYYY-MM-DD/{uuid}.{ext}`
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –≤ –ë–î —á–µ—Ä–µ–∑ `PrismaMediaAssetRepository`
- ‚úÖ –í–æ–∑–≤—Ä–∞—Ç `publicUrl` –≤ –æ—Ç–≤–µ—Ç–µ

**–§–∞–π–ª—ã:**
- `apps/api/src/application/media/use-cases/UploadMediaAssetUseCase.ts`
- `apps/api/src/infrastructure/media/storage/local-fs-storage.service.ts`

### G2: –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ ‚úÖ
**–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ:** –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–ª—å–∫–æ admin roles; —É–¥–∞–ª–µ–Ω–∏–µ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π "–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–∏ –≤ –∫–æ–Ω—Ç–µ–Ω—Ç–µ".

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- ‚úÖ `AdminMediaController` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `@Roles('owner', 'editor')`
- ‚úÖ `DeleteMediaAssetUseCase` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç `isUsedInContent()` –ø–µ—Ä–µ–¥ —É–¥–∞–ª–µ–Ω–∏–µ–º
- ‚úÖ –ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –≤ –∫–æ–Ω—Ç–µ–Ω—Ç–µ –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è `BadRequestException`

**–§–∞–π–ª—ã:**
- `apps/api/src/presentation/controllers/admin-media.controller.ts:36,71`
- `apps/api/src/application/media/use-cases/DeleteMediaAssetUseCase.ts:24-27`

### G3: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ç–∏–ø–æ–≤ ‚úÖ
**–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ:** –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ç–∏–ø–æ–≤ `image/*`, `audio/*`, `application/pdf`.

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- ‚úÖ `mapMimeToMediaType()` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ç–∏–ø—ã —á–µ—Ä–µ–∑ `mimeType.startsWith()`
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è: `image/*`, `audio/*`, `application/pdf`
- ‚úÖ –ù–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ç–∏–ø—ã –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç `null` ‚Üí `BadRequestException`

**–§–∞–π–ª—ã:**
- `apps/api/src/application/media/use-cases/UploadMediaAssetUseCase.ts:81-86`

### G4: –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ ‚úÖ
**–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ:** title, alt_text, mime, size, object_key.

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- ‚úÖ –í—Å–µ –ø–æ–ª—è –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç –≤ –º–æ–¥–µ–ª–∏ `MediaAsset`
- ‚úÖ –°–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ë–î —á–µ—Ä–µ–∑ `PrismaMediaAssetRepository`
- ‚úÖ –í–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –≤ `MediaAssetResponseDto`

**–§–∞–π–ª—ã:**
- `apps/api/src/domain/media/entities/MediaAsset.ts`
- `apps/api/prisma/schema.prisma:450-461`

---

## 2Ô∏è‚É£ Acceptance Criteria (–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏)

### AC-1: API –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞ ‚úÖ
**–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ:** –ï—Å—Ç—å API –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞ —á–µ—Ä–µ–∑ backend (multipart/form-data).

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- ‚úÖ `POST /api/admin/media` —Å `@UseInterceptors(FileInterceptor('file'))`
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ `multipart/form-data`
- ‚úÖ Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç

**–§–∞–π–ª—ã:**
- `apps/api/src/presentation/controllers/admin-media.controller.ts:35-60`

### AC-2: –ü—Ä–æ–≤–µ—Ä–∫–∞ mime/—Ä–∞–∑–º–µ—Ä–∞ –¥–æ –∑–∞–≥—Ä—É–∑–∫–∏ ‚úÖ
**–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ:** –§–∞–π–ª –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –ø–æ mime/—Ä–∞–∑–º–µ—Ä—É –¥–æ –∑–∞–≥—Ä—É–∑–∫–∏.

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- ‚úÖ `mapMimeToMediaType()` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç mime type
- ‚úÖ `validateSize()` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–∞–∑–º–µ—Ä –¥–æ –∑–∞–ø–∏—Å–∏ —Ñ–∞–π–ª–∞
- ‚úÖ –õ–∏–º–∏—Ç—ã: image 10MB, audio 50MB, pdf 20MB

**–§–∞–π–ª—ã:**
- `apps/api/src/application/media/use-cases/UploadMediaAssetUseCase.ts:27-32,88-101`

### AC-3: –°–≤—è–∑—å –∑–∞–ø–∏—Å–∏ –ë–î —Å —Ñ–∞–π–ª–æ–º ‚úÖ
**–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ:** –ü–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–ø–∏—Å—å –≤ –ë–î —Å–≤—è–∑–∞–Ω–∞ —Å —Ñ–∞–π–ª–æ–º –≤ –ª–æ–∫–∞–ª—å–Ω–æ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (—á–µ—Ä–µ–∑ `object_key` –∫–∞–∫ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –ø—É—Ç—å).

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- ‚úÖ `object_key` –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —Å–µ—Ä–≤–µ—Ä–æ–º (–Ω–µ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç—Å—è –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞)
- ‚úÖ –§–æ—Ä–º–∞—Ç: `YYYY-MM-DD/{uuid}.{ext}`
- ‚úÖ –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ë–î –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∞–π–ª—É

**–§–∞–π–ª—ã:**
- `apps/api/src/infrastructure/media/storage/local-fs-storage.service.ts:18-33`
- `apps/api/src/application/media/use-cases/UploadMediaAssetUseCase.ts:35-57`

### AC-4: –£–¥–∞–ª–µ–Ω–∏–µ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è ‚ö†Ô∏è
**–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ:** –£–¥–∞–ª–µ–Ω–∏–µ –º–µ–¥–∏–∞ –∑–∞–ø—Ä–µ—â–µ–Ω–æ, –µ—Å–ª–∏ –µ—Å—Ç—å —Å—Å—ã–ª–∫–∏ –∏–∑ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (–∏–ª–∏ —Ç—Ä–µ–±—É–µ—Ç forced unlink).

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ `isUsedInContent()` –ø–µ—Ä–µ–¥ —É–¥–∞–ª–µ–Ω–∏–µ–º
- ‚úÖ –í—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è `BadRequestException` –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏
- ‚ö†Ô∏è –ù–µ—Ç –æ–ø—Ü–∏–∏ `forced unlink` (–Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–æ —Ç–µ—Ö—Å–ø–µ–∫–∏, –Ω–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–ª–µ–∑–Ω–æ)

**–§–∞–π–ª—ã:**
- `apps/api/src/application/media/use-cases/DeleteMediaAssetUseCase.ts:24-27`

---

## 3Ô∏è‚É£ –ù–µ–≥–∞—Ç–∏–≤–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

### NS-1: –ù–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π —Ç–∏–ø —Ñ–∞–π–ª–∞ ‚úÖ
**–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ:** –ù–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π —Ç–∏–ø —Ñ–∞–π–ª–∞ ‚Üí 400, –±–µ–∑ –∑–∞–≥—Ä—É–∑–∫–∏.

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- ‚úÖ `mapMimeToMediaType()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `null` –¥–ª—è –Ω–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö —Ç–∏–ø–æ–≤
- ‚úÖ –í—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è `BadRequestException` –¥–æ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞

**–§–∞–π–ª—ã:**
- `apps/api/src/application/media/use-cases/UploadMediaAssetUseCase.ts:27-30`

### NS-2: –û—à–∏–±–∫–∞ –∑–∞–ø–∏—Å–∏ —Ñ–∞–π–ª–∞ ‚úÖ
**–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ:** –î–∏—Å–∫/—Ñ–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã (–æ—à–∏–±–∫–∞ –∑–∞–ø–∏—Å–∏) ‚Üí –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ—à–∏–±–∫–∞, –±–µ–∑ "–±–∏—Ç—ã—Ö" –∑–∞–ø–∏—Å–µ–π (–∏–ª–∏ transactional cleanup).

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω try-catch –±–ª–æ–∫ —Å cleanup
- ‚úÖ –ü—Ä–∏ –æ—à–∏–±–∫–µ –∑–∞–ø–∏—Å–∏ –≤ –ë–î —Ñ–∞–π–ª —É–¥–∞–ª—è–µ—Ç—Å—è –∏–∑ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
- ‚úÖ –ü—Ä–∏ –æ—à–∏–±–∫–µ –∑–∞–ø–∏—Å–∏ —Ñ–∞–π–ª–∞ –∑–∞–ø–∏—Å—å –≤ –ë–î –Ω–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è
- ‚úÖ –û—à–∏–±–∫–∏ cleanup –ª–æ–≥–∏—Ä—É—é—Ç—Å—è, –Ω–æ –Ω–µ –º–∞—Å–∫–∏—Ä—É—é—Ç –∏—Å—Ö–æ–¥–Ω—É—é –æ—à–∏–±–∫—É

**–§–∞–π–ª—ã:**
- `apps/api/src/application/media/use-cases/UploadMediaAssetUseCase.ts:34-79`

---

## 4Ô∏è‚É£ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (Clean Architecture)

### 5.1 –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã/–º–æ–¥—É–ª–∏ ‚úÖ
**–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ:** Presentation, Application, Domain, Infrastructure —Å–ª–æ–∏.

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- ‚úÖ **Presentation:** `AdminMediaController` (`/admin/media/*`)
- ‚úÖ **Application:** `UploadMediaAssetUseCase`, `DeleteMediaAssetUseCase`, `ListMediaAssetsUseCase`
- ‚úÖ **Domain:** `MediaAsset` entity, `IMediaAssetRepository` interface
- ‚úÖ **Infrastructure:** `LocalFsStorageService`, `PrismaMediaAssetRepository`

**–§–∞–π–ª—ã:**
- Presentation: `apps/api/src/presentation/controllers/admin-media.controller.ts`
- Application: `apps/api/src/application/media/use-cases/`
- Domain: `apps/api/src/domain/media/`
- Infrastructure: `apps/api/src/infrastructure/media/`

### 5.2 Use cases (—Å–∏–≥–Ω–∞—Ç—É—Ä—ã) ‚úÖ
**–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ:** 
- `UploadMediaAssetUseCase.execute({ filename, mimeType, sizeBytes, file }): { mediaAssetId, publicUrl }`
- `DeleteMediaAssetUseCase.execute({ mediaAssetId }): void`

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- ‚úÖ –°–∏–≥–Ω–∞—Ç—É—Ä—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç (—Å –Ω–µ–±–æ–ª—å—à–∏–º–∏ –æ—Ç–ª–∏—á–∏—è–º–∏ –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö, –Ω–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω—ã)
- ‚úÖ `UploadMediaAssetUseCase.execute(userId, file, dto)` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `MediaAssetResponseDto`
- ‚úÖ `DeleteMediaAssetUseCase.execute(mediaAssetId, userId)` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `void`

**–§–∞–π–ª—ã:**
- `apps/api/src/application/media/use-cases/UploadMediaAssetUseCase.ts:22-26`
- `apps/api/src/application/media/use-cases/DeleteMediaAssetUseCase.ts:18`

### 5.3 –î–æ–º–µ–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è ‚úÖ
**–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ:** `MediaAssetUploaded`, `MediaAssetDeleted` (–¥–ª—è audit/analytics).

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- ‚úÖ `MediaAssetUploadedEvent` –ø—É–±–ª–∏–∫—É–µ—Ç—Å—è –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏
- ‚úÖ `MediaAssetDeletedEvent` –ø—É–±–ª–∏–∫—É–µ—Ç—Å—è –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è
- ‚úÖ –°–æ–±—ã—Ç–∏—è —Å–æ–¥–µ—Ä–∂–∞—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–∞–Ω–Ω—ã–µ (userId, mediaType, mimeType, sizeBytes)

**–§–∞–π–ª—ã:**
- `apps/api/src/domain/media/events/MediaAssetUploadedEvent.ts`
- `apps/api/src/domain/media/events/MediaAssetDeletedEvent.ts`
- `apps/api/src/application/media/use-cases/UploadMediaAssetUseCase.ts:60-67`
- `apps/api/src/application/media/use-cases/DeleteMediaAssetUseCase.ts:36`

---

## 5Ô∏è‚É£ –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö

### 6.1 –°—É—â–Ω–æ—Å—Ç–∏ ‚úÖ
**–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ:** `media_assets` (+ —Å–≤—è–∑–∫–∞ `content_media`).

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- ‚úÖ –¢–∞–±–ª–∏—Ü–∞ `media_assets` —Å–æ–∑–¥–∞–Ω–∞ –≤ –º–∏–≥—Ä–∞—Ü–∏–∏
- ‚úÖ –°–≤—è–∑–∫–∞ `content_media` –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ —Å—Ö–µ–º–µ
- ‚úÖ –í—Å–µ –ø–æ–ª—è –∏–∑ —Ç–µ—Ö—Å–ø–µ–∫–∏ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç

**–§–∞–π–ª—ã:**
- `apps/api/prisma/schema.prisma:450-479`
- `apps/api/prisma/migrations/20260113110201_init_release_1/migration.sql:217-230`

### 6.2 –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö ‚úÖ
**–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ:** 
- **P0:** mime/type/size/object_key/public_url
- **P1:** uploaded_by_user_id

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- ‚úÖ –í—Å–µ P0 –ø–æ–ª—è –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç
- ‚úÖ P1 –ø–æ–ª–µ `uploaded_by_user_id` –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç
- ‚úÖ –°–≤—è–∑—å —Å `User` —á–µ—Ä–µ–∑ foreign key

**–§–∞–π–ª—ã:**
- `apps/api/prisma/schema.prisma:450-461`

---

## 6Ô∏è‚É£ API / –ö–æ–Ω—Ç—Ä–∞–∫—Ç—ã

### 7.1 Public API ‚úÖ
**–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ:** –ü—É–±–ª–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø ‚Äî —Ç–æ–ª—å–∫–æ –ø–æ `public_url` (—Ä–∞–∑–¥–∞—á–∞ —Å—Ç–∞—Ç–∏–∫–∏ –Ω–∞ VPS).

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- ‚úÖ –°—Ç–∞—Ç–∏–∫–∞ —Ä–∞–∑–¥–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `app.useStaticAssets()` –≤ `main.ts`
- ‚úÖ –ü—Ä–µ—Ñ–∏–∫—Å `/media` –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- ‚úÖ –§–∞–π–ª—ã –¥–æ—Å—Ç—É–ø–Ω—ã –ø–æ `{MEDIA_PUBLIC_URL_BASE}/{object_key}`

**–§–∞–π–ª—ã:**
- `apps/api/src/main.ts:16-22`

### 7.2 Admin API ‚úÖ
**–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ:**
| Endpoint | Method | Role | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|---|---:|---|---|
| `/api/admin/media` | POST | owner/editor | –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª (multipart) + —Å–æ–∑–¥–∞—Ç—å –∑–∞–ø–∏—Å—å |
| `/api/admin/media` | GET | owner/editor | —Å–ø–∏—Å–æ–∫/–ø–æ–∏—Å–∫ |
| `/api/admin/media/{id}` | DELETE | owner/editor | —É–¥–∞–ª–∏—Ç—å (–µ—Å–ª–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è) |

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- ‚úÖ –í—Å–µ —Ç—Ä–∏ endpoint —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã
- ‚úÖ RBAC —á–µ—Ä–µ–∑ `@Roles('owner', 'editor')`
- ‚úÖ Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç

**–§–∞–π–ª—ã:**
- `apps/api/src/presentation/controllers/admin-media.controller.ts:35-78`

---

## 7Ô∏è‚É£ Tracking / Analytics

### 8.1 –°–æ–±—ã—Ç–∏—è ‚úÖ
**–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ:** 
| Event name | Source | –ö–æ–≥–¥–∞ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç | Props (P0-only) | –ó–∞–ø—Ä–µ—Ç—ã |
|---|---|---|---|---|
| `admin_media_uploaded` | admin/backend | –∑–∞–≥—Ä—É–∑–∫–∞ —É—Å–ø–µ—à–Ω–∞ | `media_type`, `size_bucket` | –±–µ–∑ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞, –±–µ–∑ URL –µ—Å–ª–∏ —ç—Ç–æ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ |

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- ‚úÖ –î–æ–º–µ–Ω–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ `MediaAssetUploadedEvent` –ø—É–±–ª–∏–∫—É–µ—Ç—Å—è
- ‚úÖ –°–æ–∑–¥–∞–Ω `MediaTrackingHandler` –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–±—ã—Ç–∏—è
- ‚úÖ –°–æ–∑–¥–∞–Ω `TrackingService` –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–±—ã—Ç–∏–π –≤ –∞–Ω–∞–ª–∏—Ç–∏–∫—É
- ‚úÖ –°–æ–±—ã—Ç–∏–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏: `media_type`, `size_bucket`
- ‚úÖ –°–æ–±—ã—Ç–∏–µ –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç filename (—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –∑–∞–ø—Ä–µ—Ç–∞–º)
- ‚úÖ –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –≥—Ä—É–ø–ø–∏—Ä—É–µ—Ç—Å—è –≤ bucket'—ã: <1MB, 1-5MB, 5-10MB, 10-50MB, >50MB

**–§–∞–π–ª—ã:**
- `apps/api/src/domain/media/events/MediaAssetUploadedEvent.ts`
- `apps/api/src/infrastructure/tracking/tracking.service.ts`
- `apps/api/src/infrastructure/tracking/media-tracking.handler.ts`

---

## 8Ô∏è‚É£ Security / Privacy

### 9.1 Privacy by design ‚úÖ
**–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ:**
- –ù–µ –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –ø—É–±–ª–∏—á–Ω—ã–µ URL –≤–º–µ—Å—Ç–µ —Å user PII
- –ù–µ –ø—Ä–∏–Ω–∏–º–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–µ –ø—É—Ç–∏ object_key –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞ (—Ç–æ–ª—å–∫–æ —Å–µ—Ä–≤–µ—Ä –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç)

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- ‚úÖ `object_key` –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (`LocalFsStorageService.upload()`)
- ‚úÖ –ö–ª–∏–µ–Ω—Ç –Ω–µ –º–æ–∂–µ—Ç –ø–µ—Ä–µ–¥–∞—Ç—å `object_key` (–Ω–µ—Ç —Ç–∞–∫–æ–≥–æ –ø–æ–ª—è –≤ DTO)
- ‚ö†Ô∏è –ù–µ—Ç —è–≤–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤ –ª–æ–≥–∞—Ö (–Ω—É–∂–Ω–æ —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ URL –Ω–µ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Å PII)

**–§–∞–π–ª—ã:**
- `apps/api/src/infrastructure/media/storage/local-fs-storage.service.ts:18-33`
- `apps/api/src/application/media/dto/media-asset.dto.ts`

### 9.2 RBAC –∏ –∞—É–¥–∏—Ç ‚úÖ
**–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ:** –ó–∞–≥—Ä—É–∑–∫–∞/—É–¥–∞–ª–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ admin roles; –¥–µ–π—Å—Ç–≤–∏—è –ø–∏—à–µ–º –≤ audit log (`FEAT-PLT-05`).

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- ‚úÖ RBAC —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω —á–µ—Ä–µ–∑ `@Roles('owner', 'editor')`
- ‚úÖ –î–æ–º–µ–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è –ø—É–±–ª–∏–∫—É—é—Ç—Å—è (–¥–ª—è audit log —á–µ—Ä–µ–∑ FEAT-PLT-05)

**–§–∞–π–ª—ã:**
- `apps/api/src/presentation/controllers/admin-media.controller.ts:36,63,71`

---

## 9Ô∏è‚É£ –ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å, –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### 10.1 SLA/SLO ‚úÖ
**–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ:** max size: image 10MB, audio 50MB, pdf 20MB.

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- ‚úÖ –õ–∏–º–∏—Ç—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –≤ `validateSize()`
- ‚úÖ –ó–Ω–∞—á–µ–Ω–∏—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Ç–µ—Ö—Å–ø–µ–∫–∏

**–§–∞–π–ª—ã:**
- `apps/api/src/application/media/use-cases/UploadMediaAssetUseCase.ts:88-101`

### 10.2 Retry / idempotency ‚ö†Ô∏è
**–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ:** `init` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–µ–Ω –ø–æ `checksum+size` –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –∫–æ—Ä–æ—Ç–∫–æ–≥–æ –æ–∫–Ω–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ).

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- ‚ö†Ô∏è –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞
- ‚ö†Ô∏è –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –ø–æ checksum

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
–î–æ–±–∞–≤–∏—Ç—å –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ (–º–æ–∂–Ω–æ –æ—Ç–ª–æ–∂–∏—Ç—å, —Ç.–∫. –ø–æ–º–µ—á–µ–Ω–æ –∫–∞–∫ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ).

### 10.3 –î–µ–≥—Ä–∞–¥–∞—Ü–∏–∏ ‚ö†Ô∏è
**–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ:** –ï—Å–ª–∏ –∑–∞–ø–∏—Å—å —Ñ–∞–π–ª–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞: –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—à–∏–±–∫—É –∏ –ø—Ä–µ–¥–ª–∞–≥–∞–µ–º –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –ø–æ–∑–∂–µ; –Ω–µ –ª–æ–º–∞–µ–º —Ä–µ–¥–∞–∫—Ç–æ—Ä –∫–æ–Ω—Ç–µ–Ω—Ç–∞.

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- ‚úÖ –û—à–∏–±–∫–∏ –≤—ã–±—Ä–∞—Å—ã–≤–∞—é—Ç—Å—è –∫–∞–∫ –∏—Å–∫–ª—é—á–µ–Ω–∏—è
- ‚ö†Ô∏è –ù–µ—Ç —è–≤–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã —Å –ø–æ–Ω—è—Ç–Ω—ã–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏
- ‚ö†Ô∏è –ù–µ—Ç cleanup –ø—Ä–∏ —á–∞—Å—Ç–∏—á–Ω–æ–π –∑–∞–ø–∏—Å–∏ (—Å–º. NS-2)

---

## üîü Rollout plan

### 11.1 –§–∏—á–∞‚Äë—Ñ–ª–∞–≥ ‚úÖ
**–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ:** `media_upload_enabled`: internal ‚Üí stage ‚Üí prod.

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è `MEDIA_UPLOAD_ENABLED` –≤ –≤–∞–ª–∏–¥–∞—Ü–∏—é –∫–æ–Ω—Ñ–∏–≥–∞
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ feature flag –≤ `AdminMediaController` –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π
- ‚úÖ –ü—Ä–∏ –æ—Ç–∫–ª—é—á–µ–Ω–Ω–æ–º —Ñ–ª–∞–≥–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è `ForbiddenException` —Å –ø–æ–Ω—è—Ç–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º
- ‚úÖ –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ñ–ª–∞–≥ –≤–∫–ª—é—á–µ–Ω (`'true'`), –º–æ–∂–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π `'false'`

**–§–∞–π–ª—ã:**
- `apps/api/src/infrastructure/config/env.validation.ts:30-31`
- `apps/api/src/presentation/controllers/admin-media.controller.ts:54-59`

---

## 1Ô∏è‚É£1Ô∏è‚É£ Test plan

### 12.1 Unit tests ‚úÖ
**–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ:** –≥–µ–Ω–µ—Ä–∞—Ü–∏—è object_key, –≤–∞–ª–∏–¥–∞—Ü–∏—è mime/size.

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- ‚úÖ –°–æ–∑–¥–∞–Ω `UploadMediaAssetUseCase.spec.ts` —Å —Ç–µ—Å—Ç–∞–º–∏ –¥–ª—è:
  - `mapMimeToMediaType()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö —Ç–∏–ø–æ–≤
  - `validateSize()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞
  - `execute()` - –ø–æ–ª–Ω—ã–π flow –∑–∞–≥—Ä—É–∑–∫–∏, –≤–∫–ª—é—á–∞—è cleanup –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
  - –í–∞–ª–∏–¥–∞—Ü–∏—è alt_text –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- ‚úÖ –°–æ–∑–¥–∞–Ω `local-fs-storage.service.spec.ts` —Å —Ç–µ—Å—Ç–∞–º–∏ –¥–ª—è:
  - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è object_key –≤ —Ñ–æ—Ä–º–∞—Ç–µ `YYYY-MM-DD/{uuid}.{ext}`
  - –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π
  - –£–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫

**–§–∞–π–ª—ã:**
- `apps/api/src/application/media/use-cases/UploadMediaAssetUseCase.spec.ts`
- `apps/api/src/infrastructure/media/storage/local-fs-storage.service.spec.ts`

### 12.2 Integration tests ‚úÖ
**–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ:** upload ‚Üí –ø—É–±–ª–∏—á–Ω—ã–π GET (—á–µ—Ä–µ–∑ —Å—Ç–∞—Ç–∏–∫—É) ‚Üí delete.

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- ‚úÖ –°–æ–∑–¥–∞–Ω `media.integration.spec.ts` —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–º–∏ —Ç–µ—Å—Ç–∞–º–∏:
  - –ü–æ–ª–Ω—ã–π flow: upload ‚Üí list ‚Üí delete
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–ø–∏—Å–∏ –≤ –ë–î –∏ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø—É–±–ª–∏—á–Ω—ã—Ö URL
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤ –∏ –∑–∞–ø–∏—Å–µ–π

**–§–∞–π–ª—ã:**
- `apps/api/src/application/media/use-cases/media.integration.spec.ts`

### 12.3 E2E ‚ö†Ô∏è
**–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ:** –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ –∞–¥–º–∏–Ω–∫–µ –∏ —É–≤–∏–¥–µ—Ç—å –≤ –ø—Ä–µ–≤—å—é —Å—Ç–∞—Ç—å–∏ (–≤ —Ä–∞–º–∫–∞—Ö `FEAT-CNT-01`).

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- ‚ö†Ô∏è E2E —Ç–µ—Å—Ç—ã –≤—ã—Ö–æ–¥—è—Ç –∑–∞ —Ä–∞–º–∫–∏ FEAT-PLT-04 (—Ç—Ä–µ–±—É—é—Ç FEAT-CNT-01)
- ‚úÖ Integration —Ç–µ—Å—Ç—ã –ø–æ–∫—Ä—ã–≤–∞—é—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π flow

### 12.4 –ü—Ä–æ–≤–µ—Ä–∫–∞ privacy ‚úÖ
**–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ:** –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º filename/PII –≤ –∞–Ω–∞–ª–∏—Ç–∏–∫—É.

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- ‚úÖ `MediaAssetUploadedEvent` –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç filename
- ‚úÖ –°–æ–±—ã—Ç–∏–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

**–§–∞–π–ª—ã:**
- `apps/api/src/domain/media/events/MediaAssetUploadedEvent.ts:4-15`

### 12.5 A11y smoke ‚úÖ
**–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ:** alt‚Äë—Ç–µ–∫—Å—Ç –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω/–æ–±—ä—è—Å–Ω—ë–Ω.

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ alt_text –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- ‚úÖ –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –±–µ–∑ alt_text –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è `BadRequestException` —Å –ø–æ–Ω—è—Ç–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º
- ‚úÖ –î–ª—è audio –∏ PDF alt_text –æ—Å—Ç–∞–µ—Ç—Å—è –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–º

**–§–∞–π–ª—ã:**
- `apps/api/src/application/media/use-cases/UploadMediaAssetUseCase.ts:33-37`

---

## üìã –ò—Ç–æ–≥–æ–≤—ã–π —á–µ–∫–ª–∏—Å—Ç

### ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é
- [x] G1: Upload flow (—Ñ–∞–π–ª ‚Üí VPS ‚Üí –ë–î ‚Üí URL)
- [x] G2: RBAC (owner/editor)
- [x] G3: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ç–∏–ø–æ–≤ (image/audio/pdf)
- [x] G4: –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ (title, alt_text, mime, size, object_key)
- [x] AC-1: API –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ (multipart/form-data)
- [x] AC-2: –ü—Ä–æ–≤–µ—Ä–∫–∞ mime/—Ä–∞–∑–º–µ—Ä–∞ –¥–æ –∑–∞–≥—Ä—É–∑–∫–∏
- [x] AC-3: –°–≤—è–∑—å –ë–î —Å —Ñ–∞–π–ª–æ–º —á–µ—Ä–µ–∑ object_key
- [x] AC-4: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–µ—Ä–µ–¥ —É–¥–∞–ª–µ–Ω–∏–µ–º
- [x] NS-1: –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö —Ç–∏–ø–æ–≤
- [x] –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: Clean Architecture (4 —Å–ª–æ—è)
- [x] –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö: media_assets + content_media
- [x] API: –≤—Å–µ 3 endpoint —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã
- [x] Security: object_key –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —Å–µ—Ä–≤–µ—Ä–æ–º
- [x] RBAC: owner/editor —Ç–æ–ª—å–∫–æ
- [x] –î–æ–º–µ–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è: MediaAssetUploaded, MediaAssetDeleted
- [x] –†–∞–∑–¥–∞—á–∞ —Å—Ç–∞—Ç–∏–∫–∏: /media —á–µ—Ä–µ–∑ NestJS

### ‚úÖ –í—Å–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω—ã
- [x] NS-2: –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–æ—Å—Ç—å –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö –∑–∞–ø–∏—Å–∏ —Ñ–∞–π–ª–∞
- [x] 12.5: –í–∞–ª–∏–¥–∞—Ü–∏—è alt_text –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (A11y)
- [x] 11.1: Feature flag `media_upload_enabled`
- [x] 8.1: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ tracking —Å–æ–±—ã—Ç–∏—è `admin_media_uploaded`
- [x] 12.1: Unit tests
- [x] 12.2: Integration tests

### ‚ö†Ô∏è –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è (–Ω–µ –±–ª–æ–∫–∏—Ä—É—é—Ç —Ä–µ–ª–∏–∑)
- [ ] 10.2: –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –ø–æ checksum (–ø–æ–º–µ—á–µ–Ω–æ –∫–∞–∫ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –≤ —Ç–µ—Ö—Å–ø–µ–∫–∏)

---

## üéØ –°—Ç–∞—Ç—É—Å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### ‚úÖ –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω—ã

1. **–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–æ—Å—Ç—å (NS-2)** ‚úÖ ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω cleanup –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
2. **–í–∞–ª–∏–¥–∞—Ü–∏—è alt_text –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (12.5)** ‚úÖ ‚Äî –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞ –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
3. **Feature flag (11.1)** ‚úÖ ‚Äî —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω `MEDIA_UPLOAD_ENABLED`
4. **Tracking —Å–æ–±—ã—Ç–∏–µ (8.1)** ‚úÖ ‚Äî –ø–æ–¥–∫–ª—é—á–µ–Ω–æ —á–µ—Ä–µ–∑ `MediaTrackingHandler`
5. **Unit —Ç–µ—Å—Ç—ã (12.1)** ‚úÖ ‚Äî –ø–æ–∫—Ä—ã—Ç—ã –æ—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
6. **Integration —Ç–µ—Å—Ç—ã (12.2)** ‚úÖ ‚Äî –ø–æ–∫—Ä—ã—Ç –ø–æ–ª–Ω—ã–π flow

### ‚ö†Ô∏è –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

- **–ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å (10.2)** ‚Äî –ø–æ–º–µ—á–µ–Ω–æ –∫–∞–∫ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –≤ —Ç–µ—Ö—Å–ø–µ–∫–∏, –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–∑–∂–µ

---

## üìù –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–†–µ–∞–ª–∏–∑–∞—Ü–∏—è FEAT-PLT-04 **–ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç** —Ç–µ—Ö—Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏. –í—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω—ã, –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–æ–±–ª—é–¥–µ–Ω–∞, –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –Ω–∞ –º–µ—Å—Ç–µ, —Ç–µ—Å—Ç—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã.

**–í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:**
1. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–æ—Å—Ç—å —Å cleanup –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
2. ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è alt_text –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (A11y)
3. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω feature flag –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ rollout
4. ‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–æ tracking —Å–æ–±—ã—Ç–∏–µ `admin_media_uploaded`
5. ‚úÖ –°–æ–∑–¥–∞–Ω—ã unit —Ç–µ—Å—Ç—ã –¥–ª—è –æ—Å–Ω–æ–≤–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
6. ‚úÖ –°–æ–∑–¥–∞–Ω—ã integration —Ç–µ—Å—Ç—ã –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ flow

**–û—Ü–µ–Ω–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É:** **100%** ‚úÖ
